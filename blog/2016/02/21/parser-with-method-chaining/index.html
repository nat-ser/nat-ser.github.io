
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Parser With Method Chaining - instance of Nataliya</title>
  <meta name="author" content="Nataliya">

  
  <meta name="description" content="Chaining as we know it When you hear chaining methods, you think of something like this: 1
&quot;steak&quot;.upcase.reverse However, what I took for &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://nat-ser.github.io/blog/2016/02/21/parser-with-method-chaining">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="instance of Nataliya" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href='https://fonts.googleapis.com/css?family=Noto+Serif:400,700' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">instance of Nataliya</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  
  
</ul>

<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Parser With Method Chaining</h1>
    
    
      <p class="meta">
        








  



<time datetime="2016-02-21T00:00:00-05:00" pubdate data-updated="true">Feb 21st, 2016</time>
        
      </p>
    
  </header>


<div class="entry-content"><h4>Chaining as we know it </h4>


<p>When you hear chaining methods, you think of something like this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='Ruby'><span class='line'><span class="s2">&quot;steak&quot;</span><span class="o">.</span><span class="n">upcase</span><span class="o">.</span><span class="n">reverse</span>
</span></code></pre></td></tr></table></div></figure>


<p>However, what I took for granted was that &lsquo;upcase&rsquo; and &lsquo;reverse&rsquo; are built-in methods of the String Class, which means that both of those methods are available to any string because it is an instance of the String Class.</p>

<h4> Custom chaining</h4>


<p>What happens when you create your own class and want to chain methods together in this manner? For example, you want to build a data parser that allows you to do this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='Ruby'><span class='line'><span class="n">food_hash</span> <span class="o">=</span> <span class="no">Finder</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'><span class="n">food_hash</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">location</span>
</span></code></pre></td></tr></table></div></figure>


<p>instead of:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='Ruby'><span class='line'><span class="n">food_hash</span> <span class="o">=</span> <span class="no">Finder</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'><span class="n">food_hash</span><span class="o">[</span><span class="ss">:product</span><span class="o">][</span><span class="ss">:location</span><span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>This is more complicated than it looks. Let&rsquo;s dive right into an example that shows how to do this.</p>

<h4>Step by Step Example of Method Chaining </h4>


<h4>Problem:</h4>


<p>We have this nested hash called food_info.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='Ruby'><span class='line'><span class="n">food_info</span> <span class="o">=</span> <span class="p">{</span><span class="ss">fridges</span><span class="p">:</span>
</span><span class='line'>              <span class="p">{</span><span class="ss">person</span><span class="p">:</span>
</span><span class='line'>                <span class="p">{</span><span class="ss">grandma</span><span class="p">:</span><span class="o">[</span><span class="s2">&quot;cauliflower&quot;</span><span class="p">,</span> <span class="s2">&quot;sour cream&quot;</span><span class="p">,</span> <span class="s2">&quot;couch candy&quot;</span><span class="o">]</span><span class="p">,</span>
</span><span class='line'>                <span class="ss">flatiron_school</span><span class="p">:</span> <span class="o">[</span><span class="s2">&quot;donuts&quot;</span><span class="p">,</span> <span class="s2">&quot;coffee&quot;</span><span class="p">,</span> <span class="s2">&quot;siracha&quot;</span><span class="o">]</span><span class="p">,</span>
</span><span class='line'>                <span class="ss">steven</span><span class="p">:</span><span class="o">[</span><span class="s2">&quot;beef&quot;</span><span class="p">,</span> <span class="s2">&quot;ham&quot;</span><span class="o">]</span><span class="p">}</span>
</span><span class='line'>              <span class="p">},</span>
</span><span class='line'>            <span class="ss">restaurants</span><span class="p">:</span> <span class="s2">&quot;McDonalds&quot;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Your parsing code should return an object that allows you to access attributes using method calls:</p>

<p>puts object.fridges.person.grandma</p>

<h4>outputs [&ldquo;cauliflower&rdquo;, &ldquo;sour cream&rdquo;, &ldquo;couch candy&rdquo;]</h4>

<p>First example, is simply searching by key. The second example shows what would happen if we tried to do the same action in a different way.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='Ruby'><span class='line'><span class="c1">#this is the normal way to access value</span>
</span><span class='line'> <span class="nb">puts</span> <span class="n">food_info</span><span class="o">[</span><span class="ss">:fridges</span><span class="o">][</span><span class="ss">:person</span><span class="o">][</span><span class="ss">:grandma</span><span class="o">]</span> <span class="c1">##outputs [&quot;cauliflower&quot;, &quot;sour cream&quot;, &quot;couch candy&quot;]</span>
</span><span class='line'><span class="c1">#out ultimate objective is for this to work but as of now, it breaks</span>
</span><span class='line'> <span class="nb">puts</span> <span class="n">food_info</span><span class="o">.</span><span class="n">fridges</span><span class="o">.</span><span class="n">person</span><span class="o">.</span><span class="n">grandma</span> <span class="c1">##outputs NoMethoderror</span>
</span></code></pre></td></tr></table></div></figure>


<p>When we run this code it outputs the following:
<img src="/images/oh_no.png"></p>

<p>As you can see, the first method works in the way we would expect it to. The second blows up because we cannot call the <strong>fridges</strong> method because it does not exist.
Let&rsquo;s say <strong>fridges</strong> method did exist as part of the class and also <strong>person</strong> and <strong>grandma</strong> methods. If we called
<strong>puts food_info.fridges.person.grandma</strong>
it would also blow up at <strong>.person</strong> and complain that the method does not exist. This is because the <strong>food_info.fridges</strong> is no longer an instance of the same class but rather an instance of the hash class.</p>

<p>Below are the two ways to fix this.</p>

<h4>Solution 1</h4>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='Ruby'><span class='line'><span class="k">class</span> <span class="nc">Finder</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">food_info</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@food_info</span> <span class="o">=</span> <span class="n">food_info</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">fridges</span>
</span><span class='line'>  <span class="c1">#after this runs, alters value of @food_info to @food_info[:fridges]</span>
</span><span class='line'>    <span class="no">Finder</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="vi">@food_info</span><span class="o">[</span><span class="ss">:fridges</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">person</span>
</span><span class='line'>  <span class="c1">#so here we don&#39;t have to call the whole chain @food_info[:fridges][:person]</span>
</span><span class='line'>    <span class="no">Finder</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="vi">@food_info</span><span class="o">[</span><span class="ss">:person</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">grandma</span>
</span><span class='line'>    <span class="vi">@food_info</span><span class="o">[</span><span class="ss">:grandma</span><span class="o">]</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span><span class='line'><span class="n">hungerz</span> <span class="o">=</span> <span class="no">Finder</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">food_info</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="nb">puts</span> <span class="n">hungerz</span><span class="o">.</span><span class="n">fridges</span><span class="o">.</span><span class="n">person</span><span class="o">.</span><span class="n">grandma</span>
</span><span class='line'><span class="c1">####outputs [&quot;cauliflower&quot;, &quot;sour cream&quot;, &quot;couch candy&quot;]</span>
</span></code></pre></td></tr></table></div></figure>


<p>This solves the problem of method availability by creating a new instance of the class as a return value for each method. This allows us to then call the methods in one line. What this means is that when one instance method gets called, it return an actual instance of the class instead of a regular return value. That way another method of the same class can be called on the return value of its sibling method.</p>

<p>In the solution above, after the fridges method is first called, it returns an instance of the Finder class itself so that the person method is no longer getting called on a Hash value. The grandma method does not return an instance of the class because it is last in the chain.</p>

<h4>Solution 2</h4>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class='Ruby'><span class='line'><span class="k">class</span> <span class="nc">Finder</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">food_info</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@food_info</span> <span class="o">=</span> <span class="n">food_info</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">fridges</span>
</span><span class='line'>    <span class="vi">@fridges</span> <span class="o">=</span> <span class="vi">@food_info</span><span class="o">[</span><span class="ss">:fridges</span><span class="o">]</span>
</span><span class='line'>    <span class="nb">self</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">person</span>
</span><span class='line'>    <span class="vi">@person</span> <span class="o">=</span> <span class="vi">@fridges</span><span class="o">[</span><span class="ss">:person</span><span class="o">]</span>
</span><span class='line'>    <span class="nb">self</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">grandma</span>
</span><span class='line'>    <span class="vi">@person</span><span class="o">[</span><span class="ss">:grandma</span><span class="o">]</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">hungerz</span> <span class="o">=</span> <span class="no">Finder</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">food_info</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="nb">puts</span> <span class="n">hungerz</span><span class="o">.</span><span class="n">fridges</span><span class="o">.</span><span class="n">person</span><span class="o">.</span><span class="n">grandma</span>
</span><span class='line'>
</span><span class='line'><span class="c1">####outputs [&quot;cauliflower&quot;, &quot;sour cream&quot;, &quot;couch candy&quot;]</span>
</span></code></pre></td></tr></table></div></figure>


<p>This is another solution using self to do the same thing as above.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Nataliya</span></span>

      








  



<time datetime="2016-02-21T00:00:00-05:00" pubdate data-updated="true">Feb 21st, 2016</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/flatiron-school/'>flatiron_school</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://nat-ser.github.io/blog/2016/02/21/parser-with-method-chaining/" data-via="" data-counturl="http://nat-ser.github.io/blog/2016/02/21/parser-with-method-chaining/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2016/01/18/wrapper-objects-and-primitives-behind-the-scenes/" title="Previous Post: wrapper objects and primitives behind the scenes.">&laquo; wrapper objects and primitives behind the scenes.</a>
      
      
    </p>
  </footer>
</article>

</div>

  <aside class="sidebar">
   
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:nat-ser.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2016/02/21/parser-with-method-chaining/">Parser With Method Chaining</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/01/18/wrapper-objects-and-primitives-behind-the-scenes/">Wrapper Objects and Primitives Behind the Scenes.</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/12/15/prepare-for-the-worst/">Prepare for the Worst.</a>
      </li>
    
  </ul>
</section>





  
</aside>



    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2016 - Nataliya -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>



<script>
  $(document).ready(function() {  
    var stickyNavTop = $('nav').offset().top;  
      
    var stickyNav = function(){  
      var scrollTop = $(window).scrollTop(); 
      var navHasClassSticky = $('nav').hasClass('sticky');

      if (scrollTop > stickyNavTop && navHasClassSticky) {   
        return true;
      } else if (scrollTop > stickyNavTop) {
        $('nav').hide();
        $('nav').addClass('sticky');
        $('nav').fadeIn('2000');
      } else {  
        $('nav').removeClass('sticky');   
      }  
    };  
      
    stickyNav();  
      
    $(window).scroll(function() {  
      stickyNav();  
    });  
  });  
</script>


</body>
</html>
